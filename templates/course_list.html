<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SelfCOMP > Courses</title>
  <link rel="icon" type="image/png" href="/static/favicon.png">
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
  
  <header>
    <h1>SelfCOMP &gt; Courses</h1>
  </header>

  
  <nav class ="top-nav">
    <ul>
      <li><a href="/">Home</a></li>
      <li><a href="uploads">Upload</a></li>
      <li><a href="courses">Courses</a></li>
    </ul>
  </nav>
  <!--Everything above is from homepage.html-->



  <!--Container holding sidebar and main content-->
  <div class="layout">

    <!--Sidebar section-->
    <aside class="sidebar">

      <!--First group of COMP courses-->
      <div class="group">
        <!--Title-->
        <div class="group-title"><a href="#" class="group-link">COMP</a></div>
        <ul class="course-list">
          {% for course in courses if course.code.startswith('COMP') %}
            <li>
              <a href="#" class="course-link" data-code="{{ course.code }}">{{ course.code }}</a>
            </li>
          {% endfor %}
        </ul>
      </div>

      <!--Second group of MATH courses-->
      <div class="group">
        <!--Title-->
        <div class="group-title"><a href="#" class="group-link">MATH</a></div>
        <ul class="course-list">
          {% for course in courses if course.code.startswith('MATH') %}
            <li>
              <a href="#" class="course-link" data-code="{{ course.code }}">{{ course.code }}</a>
            </li>
          {% endfor %}
        </ul>
      </div>

    </aside>

    
    <main class="content">
      <h2>Course Details</h2>
      <div id="course-details">
        <p>Select a course to view its details.</p>
      </div>
    </main>
    
  </div>

<script> //built partially using VScode Copilot assitant
document.querySelectorAll('.course-link').forEach(link => {
  link.addEventListener('click', async (e) => {
    e.preventDefault();
    const code = link.dataset.code;
    const container = document.getElementById('course-details');

    try {
      const res = await fetch(`/api/course/${code}`);
      const data = await res.json();

      if (data.error) {
        container.innerHTML = `<p>${data.error}</p>`;
        return;
      }

      const instructors = Array.isArray(data.instructors) ? data.instructors : [];
      const comments = Array.isArray(data.comments) ? data.comments : [];

      container.innerHTML = `
        <h3>${data.code} - ${data.title}</h3>
        <p><strong>Description:</strong> ${data.description}</p>
        <p><strong>Prerequisites:</strong> ${data.prerequisites}</p>
        <p><strong>Hours:</strong> ${data.hours}</p>

        <h4>Instructors & Sections</h4>
        <ul class="instructors">
          ${instructors.length > 0
            ? instructors.map(i => `
                <li class="instructor">
                  <strong class="instructor-name">${i.name}</strong>
                  <ul class="terms">
                    ${Array.isArray(i.terms) ? i.terms.map(t => `<li class="term">${t}</li>`).join('') : ''}
                  </ul>
                </li>
              `).join('')
            : '<li>No instructors recorded.</li>'}
        </ul>



        

        <h4>Comments</h4>
        <ul class="comments">
          ${comments.length > 0
            ? comments.map(c => `
              <li class="comment">
                <strong class="comment-author">${c.author}</strong>
                <p class="comment-text">${c.text}</p>
            </li>
          `).join('')
        : '<li>No comments yet.</li>'}
        </ul>
      `;
    } catch (err) {
      container.innerHTML = `<p>Error loading course: ${err.message}</p>`;
    }
  });
});
</script>


</body>
</html> 
  